!function(){"use strict";var e="";const t=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},r=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?o(t,r):(t.classList.remove(r.inactiveButtonClass),t.disabled=!1)},o=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},n={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};var a=e+"d3610e9c6dce3cb370d8.svg",s=e+"2fc47fd8e9a9bcd9612f.jpg",c=e+"d38272e02bb4f1ab1c37.svg",l=e+"40608da7369d39bc1077.svg",i=e+"d73f076c46eb5467f5fc.svg";const d=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editUserAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}postCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}handleLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"1810d547-91a3-4cf2-9027-84faa0c5dd2e","Content-Type":"application/json"}});d.getAppInfo().then((e=>{let[t,r]=e;t.forEach((e=>{H(e),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"prepend";const r=H(e);N[t](r)}(e)})),v.textContent=r.name,h.textContent=r.about,u.src=r.avatar})).catch((e=>{console.error(e)})),document.getElementById("logo-svg").src=a;const u=document.getElementById("avatar");u.src=s,document.getElementById("pencil-svg").src=c,document.getElementById("new_post-svg").src=l,document.getElementById("pencil-avatar").src=i;const m=document.querySelectorAll(".modal__close-button"),_=document.querySelector(".profile__edit-button"),v=document.querySelector(".profile__name"),h=document.querySelector(".profile__description"),f=document.querySelector("#edit-modal"),y=document.forms["edit-profile-form"],p=f.querySelector(".modal__button"),b=(f.querySelector(".modal__close-button"),f.querySelector("#profile-name-input")),S=f.querySelector("#profile-description-input"),E=document.querySelector(".profile__avatar-btn"),q=document.querySelector("#avatar-modal"),g=q.querySelector(".modal__form"),C=q.querySelector("#profile-pic-input"),k=q.querySelector(".modal__button"),L=document.querySelector("#card-delete-modal"),x=L.querySelector(".modal__form"),$=(L.querySelector("#delete-submit"),document.querySelector(".profile__new-post-button")),U=document.querySelector("#new-post-modal"),j=document.forms["new-post-form"],A=U.querySelector(".modal__button"),I=(U.querySelector(".modal__close-button"),U.querySelector("#new-post-link-input")),w=U.querySelector("#new-post-caption-input"),P=document.querySelector("#preview-modal"),B=(P.querySelector(".modal__close-button"),P.querySelector(".modal__image")),D=P.querySelector(".modal__caption"),T=document.querySelector("#card-template"),N=document.querySelector(".cards__list");let O,J;function H(e){const t=T.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return r.textContent=e.name,o.setAttribute("src",e.link),o.setAttribute("alt",e.alt),e.isLiked&&n.classList.add("card__like-button_liked"),n.addEventListener("click",(t=>function(e,t,r){d.handleLike(t,r).then((()=>{e.target.classList.toggle("card__like-button_liked")})).catch((e=>{console.error(e)}))}(t,e._id,e.isLiked))),a.addEventListener("click",(r=>function(e,t){O=e,J=t,M(L)}(t,e._id))),o.addEventListener("click",(()=>{M(P),B.src=e.link,D.textContent=e.name,B.alt=e.alt})),t}function z(e){"Escape"===e.key&&F(document.querySelector(".modal_opened")),e.target.classList.contains("modal")&&F(e.target)}function M(e){e.classList.add("modal_opened"),document.addEventListener("keydown",z),e.addEventListener("mousedown",z)}function F(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",z),e.removeEventListener("mousedown",z)}var G;_.addEventListener("click",(()=>{var e;b.value=v.textContent,S.value=h.textContent,e=y,[b,S].forEach((r=>{t(e,r,n)})),M(f)})),m.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>F(t)))})),y.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;t.textContent="Saving...",d.editUserInfo({name:b.value,about:S.value}).then((e=>{v.textContent=e.name,h.textContent=e.about,F(f),o(p,n)})).catch((e=>{console.error(e)})).finally((()=>{t.textContent="Save"}))})),j.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;t.textContent="Saving...",d.postCard({name:w.value,link:I.value}).then((t=>{const r=H(t);N.prepend(r),F(U),e.target.reset(),o(A,n)})).catch((e=>{console.error(e)})).finally((()=>{t.textContent="Save"}))})),g.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;t.textContent="Saving...",d.editUserAvatar({avatar:C.value}).then((t=>{u.src=t.avatar,F(q),e.target.reset(),o(k,n)})).catch((e=>{console.error(e)})).finally((()=>{t.textContent="Save"}))})),x.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;t.textContent="Deleting...",d.deleteCard(J).then((()=>{O.remove(),F(L)})).catch((e=>{console.error(e)})).finally((()=>{t.textContent="Delete"}))})),$.addEventListener("click",(()=>{M(U)})),E.addEventListener("click",(()=>{M(q)})),G=n,Array.from(document.querySelectorAll(G.formSelector)).forEach((e=>{((e,a)=>{const s=Array.from(e.querySelectorAll(a.inputSelector)),c=e.querySelector(a.submitButtonSelector);r(s,c,a),e.addEventListener("reset",(()=>{o(c,a)})),s.forEach((o=>{o.addEventListener("input",(function(){((e,r)=>{r.validity.valid?t(e,r,n):((e,t,r,o)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(o.inputErrorClass)})(e,r,r.validationMessage,n)})(e,o),r(s,c,a)}))}))})(e,G)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGlCQUFpQnpGLEVBQU9tQixlQUNwRDRDLFNBQVNqRSxJQXRCTTJKLEVBQUMzSixFQUFhRSxLQUN0QyxNQUFNUSxFQUFZK0ksTUFBTUMsS0FDdEIxSixFQUFZMkYsaUJBQWlCekYsRUFBT29CLGdCQUVoQ1gsRUFBZ0JYLEVBQVlHLGNBQWNELEVBQU9xQixzQkFFdkRkLEVBQWtCQyxFQUFXQyxFQUFlVCxHQUU1Q0YsRUFBWStILGlCQUFpQixTQUFTLEtBQ3BDL0csRUFBY0wsRUFBZVQsRUFBTyxJQUd0Q1EsRUFBVXVELFNBQVNoRSxJQUNqQkEsRUFBYThILGlCQUFpQixTQUFTLFdBMUJoQjZCLEVBQUM1SixFQUFhQyxLQUNsQ0EsRUFBYVksU0FBU0MsTUFRekJmLEVBQWVDLEVBQWFDLEVBQWNtQixHQS9DdkJ5SSxFQUFDN0osRUFBYUMsRUFBYzZKLEVBQWM1SixLQUMxQ0YsRUFBWUcsY0FBYyxJQUFJRixFQUFhRyxZQUNuREMsWUFBY3lKLEVBQzNCN0osRUFBYUssVUFBVWEsSUFBSWpCLEVBQU9NLGdCQUFnQixFQXFDaERxSixDQUNFN0osRUFDQUMsRUFDQUEsRUFBYThKLGtCQUNiM0ksRUFJSixFQWlCSXdJLENBQW1CNUosRUFBYUMsR0FDaENRLEVBQWtCQyxFQUFXQyxFQUFlVCxFQUM5QyxHQUFFLEdBQ0YsRUFNQXlKLENBQWtCM0osRUFBYUUsRUFBTyxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvc2NyaXB0cy92YWxpZGF0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlLCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufTtcblxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gIH0pO1xufTtcblxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpO1xuICB9IGVsc2Uge1xuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcbiAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG59O1xuXG5leHBvcnQgY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbGVtZW50LCBpbnB1dExpc3QpID0+IHtcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0LCBzZXR0aW5ncyk7XG4gIH0pO1xufTtcblxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQpID0+IHtcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihcbiAgICAgIGZvcm1FbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLFxuICAgICAgc2V0dGluZ3NcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIHNldHRpbmdzKTtcbiAgfVxufTtcblxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXG4gICk7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuXG4gIGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNldFwiLCAoKSA9PiB7XG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpO1xuICB9KTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBjb25maWcpO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2luYWN0aXZlXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG4vLyBlbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiMTgxMGQ1NDctOTFhMy00Y2YyLTkwMjctODRmYWEwYzVkZDJlXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuYXBpXG4gIC5nZXRBcHBJbmZvKClcbiAgLnRoZW4oKFtjYXJkcywgdXNlcnNdKSA9PiB7XG4gICAgY2FyZHMuZm9yRWFjaCgoY2FyZCkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZCk7XG4gICAgICByZW5kZXJDYXJkKGNhcmQpO1xuICAgIH0pO1xuXG4gICAgZWRpdFByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlcnMubmFtZTtcbiAgICBlZGl0UHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlcnMuYWJvdXQ7XG4gICAgYXZhdGFySW1hZ2Uuc3JjID0gdXNlcnMuYXZhdGFyO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgfSk7XG5cbmltcG9ydCB7IGVuYWJsZVZhbGlkYXRpb24gfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5pbXBvcnQgeyBkaXNhYmxlQnV0dG9uIH0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xuaW1wb3J0IHsgc2V0dGluZ3MgfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5pbXBvcnQgeyByZXNldFZhbGlkYXRpb24gfSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XG5cbmltcG9ydCBsb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvbG9nby5zdmdcIjtcbmltcG9ydCBhdmF0YXJTcmMgZnJvbSBcIi4uL2ltYWdlcy9hdmF0YXIuanBnXCI7XG5pbXBvcnQgcGVuY2lsU3JjIGZyb20gXCIuLi9pbWFnZXMvcGVuY2lsLnN2Z1wiO1xuaW1wb3J0IG5ld1Bvc3RTcmMgZnJvbSBcIi4uL2ltYWdlcy9uZXdfcG9zdC5zdmdcIjtcbmltcG9ydCBwZW5jaWxBdmF0YXJTcmMgZnJvbSBcIi4uL2ltYWdlcy9wZW5jaWwtd2hpdGUuc3ZnXCI7XG5cbmNvbnN0IGxvZ29JbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibG9nby1zdmdcIik7XG5sb2dvSW1hZ2Uuc3JjID0gbG9nb1NyYztcbmNvbnN0IGF2YXRhckltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJhdmF0YXJcIik7XG5hdmF0YXJJbWFnZS5zcmMgPSBhdmF0YXJTcmM7XG5jb25zdCBwZW5jaWxJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGVuY2lsLXN2Z1wiKTtcbnBlbmNpbEltYWdlLnNyYyA9IHBlbmNpbFNyYztcbmNvbnN0IG5ld1Bvc3RJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmV3X3Bvc3Qtc3ZnXCIpO1xubmV3UG9zdEltYWdlLnNyYyA9IG5ld1Bvc3RTcmM7XG5jb25zdCBhdmF0YXJFZGl0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwZW5jaWwtYXZhdGFyXCIpO1xuYXZhdGFyRWRpdC5zcmMgPSBwZW5jaWxBdmF0YXJTcmM7XG5cbmltcG9ydCBnYWxheHlJbWFnZSBmcm9tIFwiLi4vaW1hZ2VzLzEuMnNjb3R0LWxvcmQtaG5CY3lGWlItLVEtdW5zcGxhc2guanBnXCI7XG5pbXBvcnQgcGFjaWZpY05vcnRoV2VzdEltYWdlIGZyb20gXCIuLi9pbWFnZXMvMi4yYWlkZW4tX2x1cUVjaGxMeFEtdW5zcGxhc2guanBnXCI7XG5pbXBvcnQgZmFsbEltYWdlIGZyb20gXCIuLi9pbWFnZXMvMy4ybm9haC1zaWxsaW1hbi15M0l3UTloVUU0QS11bnNwbGFzaC5qcGdcIjtcbmltcG9ydCByb2NreU1vdW50YWluc0ltYWdlIGZyb20gXCIuLi9pbWFnZXMvNC4ybWlrZS1zY2hlaWQteG9ZUFY0b1ZRSkktdW5zcGxhc2guanBnXCI7XG5pbXBvcnQgZ3JhdmVsQmlrZUltYWdlIGZyb20gXCIuLi9pbWFnZXMvNS4yYWxlc3Npby1zb2dnZXR0aS1zSkU5cVNlbWRGay11bnNwbGFzaC5qcGdcIjtcbmltcG9ydCBwaWtlc1BsYWNlSW1hZ2UgZnJvbSBcIi4uL2ltYWdlcy82LjJkYXZpZC1penF1aWVyZG8tWFhlYzczOGVBOUktdW5zcGxhc2guanBnXCI7XG5cbmNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcblxuLy8gcHJvZmlsZSBlZGl0IHNlbGVjdG9yc1xuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuY29uc3QgZWRpdFByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuY29uc3QgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5cbi8vIGVkaXQgbW9kYWwgZWxlbWVudHNcbmNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1tb2RhbFwiKTtcbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGRvY3VtZW50LmZvcm1zW1wiZWRpdC1wcm9maWxlLWZvcm1cIl07XG5jb25zdCBlZGl0UG9zdFN1Ym1pdEJ1dHRvbiA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG5jb25zdCBlZGl0TW9kYWxDbG9zZUJ1dHRvbiA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIik7XG5jb25zdCBlZGl0TW9kYWxOYW1lID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIpO1xuY29uc3QgZWRpdE1vZGFsRGVzY3JpcHRpb24gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuXG5jb25zdCBwcm9maWxlQXZhdGFyQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnRuXCIpO1xuY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbFwiKTtcbmNvbnN0IGF2YXRhckZvcm1FbGVtZW50ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGF2YXRhcklucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXBpYy1pbnB1dFwiKTtcbmNvbnN0IGF2YXRhclN1Ym1pdEJ1dHRvbiA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcblxuY29uc3QgY2FyZERlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLWRlbGV0ZS1tb2RhbFwiKTtcbmNvbnN0IGNhcmREZWxldGVGb3JtID0gY2FyZERlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBzdWJtaXREZWxldGVCdG4gPSBjYXJkRGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtc3VibWl0XCIpO1xuXG4vLyBuZXctcG9zdCBidXR0b25cbmNvbnN0IG5ld1Bvc3RCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25ldy1wb3N0LWJ1dHRvblwiKTtcblxuLy8gbmV3LXBvc3QgbW9kYWwgZWxlbWVudHNcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbW9kYWxcIik7XG5jb25zdCBuZXdQb3N0Rm9ybSA9IGRvY3VtZW50LmZvcm1zW1wibmV3LXBvc3QtZm9ybVwiXTtcbmNvbnN0IG5ld1Bvc3RTdWJtaXRCdXR0b24gPSBuZXdQb3N0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuY29uc3QgbmV3UG9zdENsb3NlQnV0dG9uID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcbmNvbnN0IG5ld1Bvc3RMaW5rID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbGluay1pbnB1dFwiKTtcbmNvbnN0IG5ld1Bvc3RDYXB0aW9uID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtY2FwdGlvbi1pbnB1dFwiKTtcblxuLy9pbWFnZS1wcmV2aWV3IG1vZGFsIGVsZW1lbnRzXG5jb25zdCBpbWFnZVByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcbmNvbnN0IGltYWdlUHJldmlld0Nsb3NlQnV0dG9uID0gaW1hZ2VQcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiXG4pO1xuY29uc3QgaW1hZ2VQcmV2aWV3RWwgPSBpbWFnZVByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbmNvbnN0IGltYWdlUHJldmlld0NhcHRpb24gPSBpbWFnZVByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuXG4vLyBjYXJkc1xuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcblxubGV0IHNlbGVjdGVkQ2FyZDtcbmxldCBzZWxlY3RlZENhcmRJZDtcblxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgY29uc3QgY2FyZE5hbWVFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gIGNvbnN0IGNhcmRJbWFnZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgY29uc3QgY2FyZExpa2VCdG4gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICBjb25zdCBjYXJkRGVsZXRlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xuXG4gIGNhcmROYW1lRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gIGNhcmRJbWFnZUVsLnNldEF0dHJpYnV0ZShcInNyY1wiLCBkYXRhLmxpbmspO1xuICBjYXJkSW1hZ2VFbC5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgZGF0YS5hbHQpO1xuXG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcbiAgICBjYXJkTGlrZUJ0bi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fbGlrZWRcIik7XG4gIH1cblxuICBjYXJkTGlrZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT5cbiAgICBoYW5kbGVDYXJkTGlrZShldnQsIGRhdGEuX2lkLCBkYXRhLmlzTGlrZWQpXG4gICk7XG5cbiAgY2FyZERlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT5cbiAgICBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBkYXRhLl9pZClcbiAgKTtcblxuICBjYXJkSW1hZ2VFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIG9wZW5Nb2RhbChpbWFnZVByZXZpZXdNb2RhbCk7XG4gICAgaW1hZ2VQcmV2aWV3RWwuc3JjID0gZGF0YS5saW5rO1xuICAgIGltYWdlUHJldmlld0NhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgaW1hZ2VQcmV2aWV3RWwuYWx0ID0gZGF0YS5hbHQ7XG4gIH0pO1xuXG4gIHJldHVybiBjYXJkRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gcmVuZGVyQ2FyZChpdGVtLCBtZXRob2QgPSBcInByZXBlbmRcIikge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGl0ZW0pO1xuICBjYXJkc0xpc3RbbWV0aG9kXShjYXJkRWxlbWVudCk7XG59XG5cbi8vIG9wZW4sIGNsb3NlLCBhbmQgc3VibWl0IG1vZGFsLWZvcm1zIGZ1bmN0aW9uc1xuZnVuY3Rpb24gY2xvc2VNb2RhbE9wdGlvbnMoZXZ0KSB7XG4gIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgY29uc3QgbW9kYWxPcGVuZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX29wZW5lZFwiKTtcbiAgICBjbG9zZU1vZGFsKG1vZGFsT3BlbmVkKTtcbiAgfVxuICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSkge1xuICAgIGNsb3NlTW9kYWwoZXZ0LnRhcmdldCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGNsb3NlTW9kYWxPcHRpb25zKTtcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBjbG9zZU1vZGFsT3B0aW9ucyk7XG59XG5cbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VNb2RhbE9wdGlvbnMpO1xuICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGNsb3NlTW9kYWxPcHRpb25zKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQ2FyZExpa2UoZXZ0LCBpZCwgaXNMaWtlZCkge1xuICBhcGlcbiAgICAuaGFuZGxlTGlrZShpZCwgaXNMaWtlZClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpIHtcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XG4gIHNlbGVjdGVkQ2FyZElkID0gZGF0YTtcbiAgb3Blbk1vZGFsKGNhcmREZWxldGVNb2RhbCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgY2xvc2VNb2RhbChjYXJkRGVsZXRlTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiRGVsZXRlXCI7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVkaXRGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcblxuICBhcGlcbiAgICAuZWRpdFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IGVkaXRNb2RhbE5hbWUudmFsdWUsXG4gICAgICBhYm91dDogZWRpdE1vZGFsRGVzY3JpcHRpb24udmFsdWUsXG4gICAgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgZWRpdFByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgICAgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XG4gICAgICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XG4gICAgICBkaXNhYmxlQnV0dG9uKGVkaXRQb3N0U3VibWl0QnV0dG9uLCBzZXR0aW5ncyk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBzdWJtaXRCdG4gPSBldnQuc3VibWl0dGVyO1xuICBzdWJtaXRCdG4udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xuICBhcGlcbiAgICAuZWRpdFVzZXJBdmF0YXIoeyBhdmF0YXI6IGF2YXRhcklucHV0LnZhbHVlIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIGF2YXRhckltYWdlLnNyYyA9IGRhdGEuYXZhdGFyO1xuICAgICAgY2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XG4gICAgICBldnQudGFyZ2V0LnJlc2V0KCk7XG4gICAgICBkaXNhYmxlQnV0dG9uKGF2YXRhclN1Ym1pdEJ1dHRvbiwgc2V0dGluZ3MpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVOZXdQb3N0U3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcblxuICBhcGlcbiAgICAucG9zdENhcmQoeyBuYW1lOiBuZXdQb3N0Q2FwdGlvbi52YWx1ZSwgbGluazogbmV3UG9zdExpbmsudmFsdWUgfSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsID0gZ2V0Q2FyZEVsZW1lbnQoZGF0YSk7XG4gICAgICBjYXJkc0xpc3QucHJlcGVuZChjYXJkRWwpO1xuICAgICAgY2xvc2VNb2RhbChuZXdQb3N0TW9kYWwpO1xuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xuICAgICAgZGlzYWJsZUJ1dHRvbihuZXdQb3N0U3VibWl0QnV0dG9uLCBzZXR0aW5ncyk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XG4gICAgfSk7XG59XG5cbi8vIGV2ZW50IGxpc3RlbmVycyBmb3IgYnV0dG9uc1xucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdE1vZGFsTmFtZS52YWx1ZSA9IGVkaXRQcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgZWRpdE1vZGFsRGVzY3JpcHRpb24udmFsdWUgPSBlZGl0UHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xuICByZXNldFZhbGlkYXRpb24oXG4gICAgZWRpdEZvcm1FbGVtZW50LFxuICAgIFtlZGl0TW9kYWxOYW1lLCBlZGl0TW9kYWxEZXNjcmlwdGlvbl0sXG4gICAgc2V0dGluZ3NcbiAgKTtcbiAgb3Blbk1vZGFsKGVkaXRNb2RhbCk7XG59KTtcblxuY2xvc2VCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xuICBjb25zdCBtb2RhbCA9IGJ1dHRvbi5jbG9zZXN0KFwiLm1vZGFsXCIpO1xuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwobW9kYWwpKTtcbn0pO1xuXG5lZGl0Rm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVFZGl0Rm9ybVN1Ym1pdCk7XG5uZXdQb3N0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZU5ld1Bvc3RTdWJtaXQpO1xuYXZhdGFyRm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KTtcbmNhcmREZWxldGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRGVsZXRlU3VibWl0KTtcblxubmV3UG9zdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwobmV3UG9zdE1vZGFsKTtcbn0pO1xuXG5wcm9maWxlQXZhdGFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG9wZW5Nb2RhbChhdmF0YXJNb2RhbCk7XG59KTtcblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgZ2V0QXBwSW5mbygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBhYm91dCxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIGVkaXRVc2VyQXZhdGFyKHsgYXZhdGFyIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICBwb3N0Q2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBsaW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlTGlrZShpZCwgaXNMaWtlZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImNvbmZpZyIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiaW5wdXRFcnJvckNsYXNzIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVkIiwiYWRkIiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJlcnJvckNsYXNzIiwiYXBpIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEFwcEluZm8iLCJQcm9taXNlIiwiYWxsIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJyZWplY3QiLCJzdGF0dXMiLCJlZGl0VXNlckluZm8iLCJfcmVmMiIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdFVzZXJBdmF0YXIiLCJfcmVmMyIsImF2YXRhciIsInBvc3RDYXJkIiwiX3JlZjQiLCJsaW5rIiwiZGVsZXRlQ2FyZCIsImhhbmRsZUxpa2UiLCJpc0xpa2VkIiwiYXV0aG9yaXphdGlvbiIsImNhcmRzIiwidXNlcnMiLCJmb3JFYWNoIiwiY2FyZCIsImdldENhcmRFbGVtZW50IiwiaXRlbSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImNhcmRFbGVtZW50IiwiY2FyZHNMaXN0IiwicmVuZGVyQ2FyZCIsImVkaXRQcm9maWxlTmFtZSIsImVkaXRQcm9maWxlRGVzY3JpcHRpb24iLCJhdmF0YXJJbWFnZSIsInNyYyIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImxvZ29TcmMiLCJhdmF0YXJTcmMiLCJwZW5jaWxTcmMiLCJuZXdQb3N0U3JjIiwicGVuY2lsQXZhdGFyU3JjIiwiY2xvc2VCdXR0b25zIiwicXVlcnlTZWxlY3RvckFsbCIsInByb2ZpbGVFZGl0QnV0dG9uIiwiZWRpdE1vZGFsIiwiZWRpdEZvcm1FbGVtZW50IiwiZm9ybXMiLCJlZGl0UG9zdFN1Ym1pdEJ1dHRvbiIsImVkaXRNb2RhbE5hbWUiLCJlZGl0TW9kYWxEZXNjcmlwdGlvbiIsInByb2ZpbGVBdmF0YXJCdG4iLCJhdmF0YXJNb2RhbCIsImF2YXRhckZvcm1FbGVtZW50IiwiYXZhdGFySW5wdXQiLCJhdmF0YXJTdWJtaXRCdXR0b24iLCJjYXJkRGVsZXRlTW9kYWwiLCJjYXJkRGVsZXRlRm9ybSIsIm5ld1Bvc3RCdXR0b24iLCJuZXdQb3N0TW9kYWwiLCJuZXdQb3N0Rm9ybSIsIm5ld1Bvc3RTdWJtaXRCdXR0b24iLCJuZXdQb3N0TGluayIsIm5ld1Bvc3RDYXB0aW9uIiwiaW1hZ2VQcmV2aWV3TW9kYWwiLCJpbWFnZVByZXZpZXdFbCIsImltYWdlUHJldmlld0NhcHRpb24iLCJjYXJkVGVtcGxhdGUiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImRhdGEiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZE5hbWVFbCIsImNhcmRJbWFnZUVsIiwiY2FyZExpa2VCdG4iLCJjYXJkRGVsZXRlQnRuIiwic2V0QXR0cmlidXRlIiwiYWx0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsInRhcmdldCIsInRvZ2dsZSIsImhhbmRsZUNhcmRMaWtlIiwiX2lkIiwib3Blbk1vZGFsIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImNsb3NlTW9kYWxPcHRpb25zIiwia2V5IiwiY2xvc2VNb2RhbCIsImNvbnRhaW5zIiwibW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicmVzZXRWYWxpZGF0aW9uIiwidmFsdWUiLCJpbnB1dCIsImJ1dHRvbiIsImNsb3Nlc3QiLCJwcmV2ZW50RGVmYXVsdCIsInN1Ym1pdEJ0biIsInN1Ym1pdHRlciIsImZpbmFsbHkiLCJjYXJkRWwiLCJwcmVwZW5kIiwicmVzZXQiLCJBcnJheSIsImZyb20iLCJzZXRFdmVudExpc3RlbmVycyIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlIiwidmFsaWRhdGlvbk1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9